<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<!-- ===== META DATA / SEO ===== -->
<meta name="title" content="Elecci√≥n de tratamiento en FOP ‚Äî Ictus GPS">
<meta name="description" content="Herramienta cl√≠nica interactiva basada en la escala RoPE y los criterios anat√≥micos y cl√≠nicos (A+C) para orientar la elecci√≥n de tratamiento en el foramen oval permeable (FOP) tras ictus isqu√©mico. Desarrollado por Rafael Bustamante Toledo.">
<meta name="keywords" content="FOP, foramen oval permeable, RoPE, ictus criptog√©nico, cierre percut√°neo, embolia paradojal, neurolog√≠a vascular, Ictus GPS, tratamiento ictus, prevenci√≥n secundaria, cierre FOP">
<meta name="author" content="Unidad de Ictus ¬∑ Hospital Regional Universitario de M√°laga">
<meta name="robots" content="index, follow">
<meta property="og:title" content="Elecci√≥n de tratamiento en FOP ‚Äî Ictus GPS">
<meta property="og:description" content="Escala RoPE + A + C para estimar la probabilidad de causalidad del FOP y orientar el manejo (cierre percut√°neo, antiagregaci√≥n o consenso multidisciplinar).">
<meta property="og:type" content="website">
<meta property="og:image" content="../iconos/ictusgps.png">
<meta property="og:locale" content="es_ES">
<meta name="theme-color" content="#0f3d83">

<title>Elecci√≥n de tratamiento en FOP (RoPE + A + C)</title>
<link rel="icon" type="image/png" sizes="192x192" href="../iconos/ictusgps.png">
<link rel="apple-touch-icon" sizes="180x180" href="../iconos/ictusgps.png">
<meta name="theme-color" content="#0f3d83">

<style>
:root{
  --bg:#f8fafc;--ink:#0f172a;--borde:#e5e7eb;
  --ok:#166534;--ok-bg:#e9fce7;--ok-ring:#bbf7d0;
  --mid:#92400e;--mid-bg:#fff7ed;--mid-ring:#fed7aa;
  --bad:#991b1b;--bad-bg:#fef2f2;--bad-ring:#fecaca;
  --accent:#2563eb;
}
body{margin:0;background:var(--bg);color:var(--ink);font-family:Verdana, Geneva, sans-serif}

/* CABECERA */
.appbar{position:sticky;top:0;z-index:1000;background:#0f3d83;color:#fff;box-shadow:0 2px 6px rgba(0,0,0,.1)}
.appbar-inner{max-width:980px;margin:0 auto;padding:6px 16px;display:flex;align-items:center;justify-content:space-between;gap:12px}
.left-group{display:flex;align-items:center;gap:10px;flex-wrap:wrap}
.appbar h1{margin:0;font-size:20px;font-weight:800}
.pill{display:inline-flex;align-items:center;justify-content:center;min-width:38px;height:28px;padding:4px 10px;border-radius:999px;font-size:13px;font-weight:700;border:1px solid transparent;white-space:nowrap}
.pill-init{background:#dbeafe;color:#1e3a8a;border-color:#bfdbfe}
.pill-ok{background:#dcfce7;color:#065f46;border-color:#86efac}
.pill-warn{background:#fef3c7;color:#92400e;border-color:#fde68a}
.pill-bad{background:#fee2e2;color:#991b1b;border-color:#fecaca}
.btn{display:inline-flex;align-items:center;justify-content:center;height:32px;padding:0 14px;border-radius:10px;text-decoration:none;border:1px solid rgba(127,179,255,.35);background:#1c60c3;color:#fff;font-size:.9rem;font-weight:700}
.btn:hover{background:#0C00FF}

/* BLOQUES */
.wrap{max-width:980px;margin:16px auto 48px;padding:0 16px}
.panel{background:#fff;border:1px solid var(--borde);border-radius:16px;padding:16px;box-shadow:0 2px 10px rgba(15,23,42,.06)}
.block{border-radius:14px;padding:14px 16px;margin:14px 0;transition:background .3s}
.block h3{margin:0 0 8px 0;font-size:1.05rem;font-weight:800;display:flex;align-items:center;gap:6px}
.block.rope{background:#eff6ff;border-left:4px solid #3b82f6}
.block.anat{background:#ecfdf5;border-left:4px solid #10b981}
.block.clin{background:#fffbeb;border-left:4px solid #f59e0b}
.block.info{background:#ffffff;border-left:4px solid #000000}

.block:hover{box-shadow:0 2px 6px rgba(0,0,0,.08)}
.note{color:#64748b;font-size:12px;margin:6px 0 12px}
label{font-weight:400;color:#1e293b;margin-top:8px;display:block}
select{width:100%;padding:10px 12px;border:1px solid #cbd5e1;border-radius:10px;background:#fff;font-size:14px}
.grid{display:grid;gap:10px}
@media(min-width:860px){.grid.cols-2{grid-template-columns:1fr 1fr}}
.check{display:flex;align-items:flex-start;gap:8px;margin:6px 0;color:#1e293b;font-weight:400;transition:color .2s}
.check:hover{color:#0f3d83}
.check input{margin-top:2px;transform:scale(1.05);accent-color:#0f3d83}

/* RESULTADOS */
.kpi{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-top:10px}
.box{border:1.5px dashed #c7dbff;border-radius:14px;padding:14px;background:#f8fbff;text-align:center}
.ttl{font-size:14px;color:#334155;font-weight:800;margin-bottom:2px}
.val{font-size:22px;font-weight:900;color:#0b2c5f}
.mini{font-size:12px;color:#64748b;margin-top:4px}
.ok{background:var(--ok-bg);border-color:var(--ok-ring)}
.warn{background:var(--mid-bg);border-color:var(--mid-ring)}
.bad{background:var(--bad-bg);border-color:var(--bad-ring)}
.ok .val{color:var(--ok)}.warn .val{color:var(--mid)}.bad .val{color:var(--bad)}

/* BOTONES */
.actions{display:flex;gap:10px;flex-wrap:wrap;margin-top:18px}
.btn-action{flex:1 1 32%;border:none;border-radius:10px;padding:12px;font-size:15px;font-weight:700;cursor:pointer}
.btn-clear{background:#fff;color:#0b2c5f;border:1px solid #2563eb}
.btn-clear:hover{background:#eff6ff}
.btn-copy{background:#fff;color:#0f3d83;border:1px solid #2563eb}
.btn-copy:hover{background:#eff6ff}
.btn-copy.copiado{background:#0f3d83!important;color:#fff!important}
.btn-calc{background:#0f3d83;color:#fff;border:1px solid #0f3d83}
.btn-calc:hover{background:#1c60c3}

/* OTROS */
#resumenText{white-space:pre-wrap;font-size:13px;color:#0f172a;margin-top:12px;border:1px dashed var(--borde);border-radius:10px;padding:10px 12px;background:#f8fafc;line-height:1.45}
.advertencia{background:#fffbe6;border-left:4px solid #f59e0b;padding:10px;border-radius:10px;font-size:13px;color:#78350f;margin-top:16px;line-height:1.5}
footer{position:relative;left:50%;transform:translateX(-50%);width:100vw;margin:2rem 0 0 0;padding:1.5rem 0;border-top:1px solid #e5e7eb;background:#ffffff;text-align:center;box-shadow:0 -2px 6px rgba(0,0,0,.04)}
/* =======================================================
   DISCLAIMER FINAL ‚Äî fondo rojo tenue
======================================================= */
.disclaimer-red{
  background:#fef2f2;             /* rojo muy claro */
  border:1px solid #fecaca;       /* borde rosado suave */
  border-radius:12px;
  padding:14px 16px;
  margin:28px auto 0;
  max-width:960px;
  box-shadow:0 2px 8px rgba(185,28,28,0.05);
}
.disclaimer-red p{
  margin:0;
  color:#7f1d1d;                  /* texto rojo oscuro */
  font-size:14px;
  line-height:1.5;
  text-align:left;
}
.disclaimer-red b{
  color:#991b1b;
}
/* Bot√≥n Volver inferior */
.back-btn{
  display:inline-block;
  margin:1.5rem auto 0;
  background:#0f3d83;
  color:#fff;
  text-decoration:none;
  font-weight:700;
  padding:0.7rem 1.4rem;
  border-radius:10px;
  box-shadow:0 4px 10px rgba(15,61,131,.25);
  transition:background .2s, transform .1s, box-shadow .2s;
}
.back-btn:hover{
  background:#1c60c3;
  transform:translateY(-1px);
  box-shadow:0 6px 12px rgba(15,61,131,.35);
}
</style>
</head>

<body>
<header class="appbar">
  <div class="appbar-inner">
    <div class="left-group">
      <h1>Elecci√≥n de tratamiento en FOP</h1>
      <output id="pill" class="pill pill-init">‚Äî</output>
    </div>
    <a class="btn" href="../index.html">Inicio</a>
  </div>
</header>

<main class="wrap">
<section class="panel">
<p class="note">Herramienta cl√≠nica interactiva basada en la escala RoPE y los criterios anat√≥micos y cl√≠nicos (A+C) para orientar la elecci√≥n de tratamiento en el foramen oval permeable (FOP) tras ictus isqu√©mico.</p>

<!-- BLOQUE ROPE -->
<div class="block rope">
  <h3>üßÆ Escala RoPE</h3>
  <div class="grid cols-2">
    <div>
      <label>Edad</label>
      <select id="age">
        <option value="">Selecciona‚Ä¶</option>
        <option value="5">‚â§30</option><option value="4">31‚Äì40</option>
        <option value="3">41‚Äì50</option><option value="2">51‚Äì60</option>
        <option value="1">61‚Äì70</option><option value="0">>70</option>
      </select>
    </div>
    <div>
      <label>Factores cl√≠nicos ausentes</label>
      <label class="check"><input type="checkbox" id="noHTN"> No HTA</label>
      <label class="check"><input type="checkbox" id="noDM"> No DM</label>
      <label class="check"><input type="checkbox" id="noSmoke"> No tabaco</label>
      <label class="check"><input type="checkbox" id="noPrior"> No ictus/AIT previo</label>
      <label class="check"><input type="checkbox" id="cortical"> Infarto cortical</label>
    </div>
  </div>
</div>

<!-- BLOQUE ANAT√ìMICO -->
<!-- BLOQUE ANAT√ìMICO (actualizado y simplificado) -->
<div class="block anat">
  <h3>ü´Ä Caracter√≠sticas anat√≥micas</h3>
  <div class="grid cols-2">
    <label class="check"><input type="checkbox" id="asa"> Aneurisma o movilidad del tabique interauricular (ASA ‚â•10‚Äì15 mm o septo laxo)</label>
    <label class="check"><input type="checkbox" id="largeShunt"> Gran paso D‚ÜíI / shunt tipo ‚Äúen ducha o cortina‚Äù</label>
    <label class="check"><input type="checkbox" id="longTunnel"> Canal interauricular largo (>8 mm)</label>
    <label class="check"><input type="checkbox" id="eustachian"> V√°lvula de Eustaquio o red de Chiari prominente</label>
    <label class="check"><input type="checkbox" id="pulmShunt"> Shunt pulmonar coexistente</label>
  </div>
</div>

<!-- BLOQUE CL√çNICO -->
<div class="block clin">
  <h3>üë©‚Äç‚öïÔ∏è Situaciones cl√≠nicas relevantes</h3>
  <div class="grid cols-2">
    <label class="check"><input type="checkbox" id="crypt60"> Ictus criptog√©nico en menor de 60 a√±os</label>
    <label class="check"><input type="checkbox" id="noOtherCause"> Sin otra causa (TOAST)</label>
    <label class="check"><input type="checkbox" id="noAF"> Sin FA documentada</label>
    <label class="check"><input type="checkbox" id="embolicPattern"> Patr√≥n emb√≥lico o cortical</label>
    <label class="check"><input type="checkbox" id="recurOnAP"> Recurrencia bajo antiagregante</label>
    <label class="check"><input type="checkbox" id="lowBleed"> Riesgo hemorr√°gico bajo</label>
    <label class="check"><input type="checkbox" id="contraClose"> <span style="color:#991b1b; font-weight:700;">
Contraindicaci√≥n para cierre</span></label>
</div></div>
<div class="block info">
<!-- Detalles explicativos -->
 <div class="note"> 
<details style="margin-top:16px;">
    <summary style="cursor:pointer;font-weight:700;color:#0f3d83;">
      üìã Explicaci√≥n de los factores anat√≥micos y cl√≠nicos
    </summary>
    <div style="margin-top:8px;font-size:13px;line-height:1.5;color:#1e293b;">
      <b>Factores anat√≥micos de alto riesgo:</b>
      <ul>
        <li><b>Aneurisma del septo interauricular (ASA):</b> movilidad septal >10‚Äì15 mm; favorece el paso de √©mbolos.</li>
        <li><b>Septo laxo:</b> variabilidad septal que aumenta riesgo de embolia parad√≥jica.</li>
        <li><b>Gran paso derecha‚Äìizquierda:</b> shunt significativo visible en reposo o con maniobra de Valsalva.</li>
        <li><b>Shunt tipo ‚Äúen ducha o cortina‚Äù:</b> m√∫ltiples microburbujas que indican paso masivo.</li>
        <li><b>Canal largo:</b> t√∫nel interauricular >8 mm, mantiene comunicaci√≥n abierta.</li>
        <li><b>V√°lvula de Eustaquio / red de Chiari:</b> estructuras que dirigen el flujo hacia el FOP.</li>
        <li><b>Shunt pulmonar:</b> paso alternativo de √©mbolos, relevante si coexistente con FOP.</li>
      </ul>

      <b>Situaciones cl√≠nicas relevantes:</b>
      <ul>
        <li><b>Ictus criptog√©nico &lt;60 a√±os:</b> mayor probabilidad de FOP causal.</li>
        <li><b>Sin otra causa (TOAST no cardioemb√≥lico):</b> refuerza el v√≠nculo causal del FOP.</li>
        <li><b>Sin FA documentada:</b> descartada fuente embol√≠gena alternativa (monitorizaci√≥n prolongada).</li>
        <li><b>Patr√≥n emb√≥lico o cortical:</b> infarto compatible con embolia paradojal.</li>
        <li><b>Recurrencia bajo antiagregante:</b> sugiere fracaso del tratamiento m√©dico.</li>
        <li><b>Riesgo hemorr√°gico bajo:</b> condici√≥n favorable para cierre percut√°neo.</li>
      </ul>
    </div>
  </details>
</div>

</div>


<!-- BOTONES -->
<div class="actions">
  <button id="btnCalc" class="btn-action btn-calc">Calcular</button>
  <button id="btnClear" class="btn-action btn-clear">Borrar</button>
  <button id="btnCopy" class="btn-action btn-copy">Copiar resumen</button>
</div>

<!-- RESULTADOS -->
<!-- RESULTADOS -->
<div class="panel" id="resultCard" style="margin-top:16px;display:none;">
  <div class="kpi">
    <div class="box" id="ropeBox">
      <div class="ttl">RoPE</div>
      <div class="val" id="scoreVal">-</div>
      <div class="mini" id="probVal">-</div>
    </div>
    <div class="box" id="classBox">
      <div class="ttl">Categor√≠a RoPE</div>
      <div class="val" id="classVal">-</div>
      <div class="mini" id="interpVal">-</div>
    </div>
  </div>

  <div class="kpi">
    <div class="box" id="aBox">
      <div class="ttl">Rasgos anat√≥micos (A)</div>
      <div class="val" id="aVal">0</div>
    </div>
    <div class="box" id="cBox">
      <div class="ttl">Criterios cl√≠nicos (C)</div>
      <div class="val" id="cVal">0</div>
    </div>
  </div>

  <!-- Recomendaci√≥n ocupa todo el ancho -->
  <div style="margin-top:12px;">
    <div class="box" id="recBox">
      <div class="ttl">Recomendaci√≥n orientativa</div>
      <div class="val" id="recVal">-</div>
      <div class="mini" id="recNote">-</div>
    </div>
  </div>

  <div id="resumenText"></div>
<!-- Disclaimer final con fondo rojo tenue -->
<div class="disclaimer-red">
  <p>
    <b>Advertencia.</b> Esta herramienta tiene car√°cter orientativo y no sustituye el juicio cl√≠nico del profesional sanitario ni la discusi√≥n multidisciplinar.
    Las recomendaciones ofrecidas deben interpretarse en el contexto individual de cada paciente     y conforme a los protocolos locales y las gu√≠as de referencia.
  </p>
</div>
</div>
</section>
<div style="text-align:center;">
  <a href="index.html" class="back-btn">Volver</a>
</div>
</main>

<script>
const PROB={0:'28%',1:'30%',2:'35%',3:'44%',4:'55%',5:'61%',6:'67%',7:'78%',8:'84%',9:'88%',10:'90%'};
const idsAnat=['asa','largeShunt','longTunnel','eustachian','pulmShunt'];
const idsClin=['crypt60','noOtherCause','noAF','embolicPattern','recurOnAP','lowBleed'];
const $=id=>document.getElementById(id);

const toneFor=s=>s>=7?'bad':(s>=4?'warn':'ok');
const labelFor=s=>s>=7?'Alta':(s>=4?'Intermedia':'Baja');
const interpFor=s=>s>=7?'Probabilidad alta: perfil joven, sin FR y patr√≥n cortical.':(s>=4?'Probabilidad intermedia: valorar beneficio-riesgo.':'Probabilidad baja: preferir manejo m√©dico salvo otros hallazgos.');

function getAnat(){return idsAnat.filter(id=>$(id).checked)}
function getClin(){return idsClin.filter(id=>$(id).checked)}

function decideReco(score,A,C,contra){
  if(contra) return {rec:'Evitar cierre percut√°neo: manejo m√©dico',note:'Contraindicaci√≥n o alto riesgo para cierre',tone:'bad'};
  if(score>=7 && A>=1) return {rec:'Cierre percut√°neo recomendado',note:'RoPE alta + ‚â•1 rasgo anat√≥mico',tone:'ok'};
  if(score>=4 && score<=6 && (A>=2 || C>=2)) return {rec:'Valorar cierre en consenso multidisciplinar',note:'RoPE intermedia + (A‚â•2 o C‚â•2)',tone:'warn'};
  if(score<=3 && A===0 && C<=1) return {rec:'Manejo m√©dico (antiagregante / seg√∫n caso)',note:'Baja probabilidad causal y sin alto riesgo anat√≥mico',tone:'bad'};
  return {rec:'Valorar cierre en consenso multidisciplinar',note:'Perfil intermedio / datos mixtos',tone:'warn'};
}

function mostrarResumen(s,prob,cat,A,C,decision,contra){
const selAnat=getAnat().map(id=>({
  asa:'Aneurisma o movilidad del tabique interauricular (ASA ‚â•10‚Äì15 mm o septo laxo)',
  largeShunt:'Gran paso D‚ÜíI / shunt tipo ‚Äúen ducha‚Äù',
  longTunnel:'Canal interauricular largo (>8 mm)',
  eustachian:'V√°lvula de Eustaquio o red de Chiari prominente',
  pulmShunt:'Shunt pulmonar coexistente'
}[id]));

  const selClin=getClin().map(id=>({crypt60:'Ictus criptog√©nico <60',noOtherCause:'Sin otra causa (TOAST)',noAF:'Sin FA documentada',embolicPattern:'Patr√≥n emb√≥lico',recurOnAP:'Recurrencia con AAS',lowBleed:'Riesgo hemorr√°gico bajo'}[id]));

  let t = `FOP ‚Äì Recomendaci√≥n (Ictus GPS)\n`;
  t += `================================\n`;
  t += `RoPE: ${s}/10 ‚Äî Prob. FOP causal: ${prob} (${cat})\n`;
  t += `Rasgos anat√≥micos (A): ${A}${A ? ' ‚Üí ' + selAnat.join(', ') : ''}\n`;
  t += `Criterios cl√≠nicos (C): ${C}${C ? ' ‚Üí ' + selClin.join(', ') : ''}\n`;
  if(contra) t += `*Nota seguridad*: Contraindicaci√≥n o alto riesgo para cierre.\n`;
  t += `\nRecomendaci√≥n: ${decision.rec} ‚Äî ${decision.note}\n`;
  t += `\nReferencias: AHA/ASA 2021; ESO 2021.\n`;
  t += `Aviso: herramienta orientativa; no sustituye el juicio cl√≠nico ni la discusi√≥n multidisciplinar.`;
  $('resumenText').textContent = t;
}

function calcular(){
  const age=$('age').value;
  if(age===''){ 
    $('resultCard').style.display='none';
    $('pill').className='pill pill-init';
    $('pill').textContent='‚Äî';
    return;
  }
  let s=parseInt(age,10);
  ['noHTN','noDM','noSmoke','noPrior','cortical'].forEach(id=>{if($(id).checked)s+=1;});
  s=Math.max(0,Math.min(10,s));
  const prob=PROB[s]||'‚Äî',cat=labelFor(s),tone=toneFor(s);
  const A=getAnat().length,C=getClin().length,contra=$('contraClose').checked;
  const decision=decideReco(s,A,C,contra);

  $('scoreVal').textContent=s;
  $('probVal').textContent=prob;
  $('classVal').textContent=cat;
  $('interpVal').textContent=interpFor(s);
  ['ropeBox','classBox'].forEach(id=>{
    const el=$(id);
    el.classList.remove('ok','warn','bad');
    el.classList.add(tone);
  });
  $('aVal').textContent=A;
  $('cVal').textContent=C;
  ['aBox','cBox','recBox'].forEach(id=>{
    const el=$(id);
    el.classList.remove('ok','warn','bad');
    el.classList.add(decision.tone);
  });
  $('recVal').textContent=decision.rec;
  $('recNote').textContent=decision.note;

  $('resultCard').style.display='block';

  const pill=$('pill');
  pill.className='pill '+(decision.tone==='ok'?'pill-ok':decision.tone==='warn'?'pill-warn':'pill-bad');
  pill.textContent=`RoPE ${s} ¬∑ ${prob} ‚Äî ${decision.rec}`;

  mostrarResumen(s,prob,cat,A,C,decision,contra);
}

function borrar(){
  $('age').value='';
  ['noHTN','noDM','noSmoke','noPrior','cortical','contraClose',...idsAnat,...idsClin].forEach(id=>{
    if($(id)) $(id).checked=false;
  });
  $('resultCard').style.display='none';
  $('pill').className='pill pill-init';
  $('pill').textContent='‚Äî';
  $('resumenText').textContent='';
}

function copiar(){
  const t=$('resumenText').textContent.trim();
  if(!t) return;
  navigator.clipboard.writeText(t).then(()=>{
    const b=$('btnCopy');
    b.classList.add('copiado');
    b.textContent='Copiado';
    setTimeout(()=>{
      b.classList.remove('copiado');
      b.textContent='Copiar resumen';
    },1200);
  });
}

$('btnCalc').addEventListener('click',calcular);
$('btnClear').addEventListener('click',borrar);
$('btnCopy').addEventListener('click',copiar);
</script>
<footer>
  <img src="uibanner.png" alt="Unidad de Ictus M√°laga" style="max-width:380px;height:auto;opacity:.96">
</footer>
<script src="js/index.js"></script>
</body>
</html>
